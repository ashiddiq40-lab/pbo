<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Login JSON OOP</title>

<style>
  body {
    margin: 0;
    height: 100vh;
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: Arial, sans-serif;
    background: linear-gradient(135deg, #ff0000, #009900, #0099ff);
  }

  .card {
    width: 330px;
    padding: 25px;
    background: white;
    border-radius: 10px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.2);
    text-align: center;
  }

  h2 {
    margin-bottom: 20px;
  }

  input {
    width: 100%;
    padding: 10px;
    margin-bottom: 10px;
    border-radius: 5px;
    border: 1px solid #ccc;
  }

  button {
    width: 100%;
    padding: 10px;
    border: none;
    border-radius: 5px;
    color: white;
    font-size: 15px;
    cursor: pointer;
  }

  .login-btn {
    background: #1e90ff;
  }

  .logout-btn {
    background: #e74c3c;
  }

  #dashboard {
    display: none;
  }

  .welcome {
    font-size: 18px;
    font-weight: bold;
    color: #27ae60;
    margin-bottom: 20px;
  }
</style>
</head>
<body>

<!-- LOGIN -->
<div class="card" id="loginPage">
  <h2>Login</h2>
  <input type="text" id="username" placeholder="Username">
  <input type="password" id="password" placeholder="Password">
  <button class="login-btn" onclick="login()">Login</button>
</div>

<!-- DASHBOARD -->
<div class="card" id="dashboard">
  <div class="welcome" id="welcomeText"></div>
  <button class="logout-btn" onclick="logout()">Logout</button>
</div>

<script>
/* =======================
   DATASET JSON
======================= */
const dataUser = [
  { username: "admin", password: "123", nama: "Administrator" },
  { username: "user", password: "456", nama: "User" },
  { username: "shiddiq", password: "ooo", nama: "Shiddiq" }
];

/* =======================
   SIMPAN DATASET KE LOCAL STORAGE
======================= */
if (!localStorage.getItem("dataUser")) {
  localStorage.setItem("dataUser", JSON.stringify(dataUser));
}

/* =======================
   CLASS LOGIN (OOP)
======================= */
class LoginApp {
  constructor(users) {
    this.users = users;
  }

  findUser(username) {
    return this.users.find(u => u.username === username);
  }

  checkPassword(user, password) {
    return user.password === password;
  }
}

/* =======================
   OBJECT DARI CLASS
======================= */
const usersFromStorage = JSON.parse(localStorage.getItem("dataUser"));
const app = new LoginApp(usersFromStorage);

/* =======================
   LOGIN FUNCTION
======================= */
function login() {
  const username = document.getElementById("username").value;
  const password = document.getElementById("password").value;

  const user = app.findUser(username);

  if (!user) {
    alert("Username salah");
    return;
  }

  if (!app.checkPassword(user, password)) {
    alert("Password salah");
    return;
  }

  // SIMPAN STATUS LOGIN
  localStorage.setItem("statusLogin", "true");
  localStorage.setItem("userLogin", JSON.stringify(user));

  document.getElementById("username").value = "";
  document.getElementById("password").value = "";

  tampilDashboard();
}

/* =======================
   TAMPIL DASHBOARD
======================= */
function tampilDashboard() {
  const userLogin = JSON.parse(localStorage.getItem("userLogin"));

  document.getElementById("loginPage").style.display = "none";
  document.getElementById("dashboard").style.display = "block";

  document.getElementById("welcomeText").innerText =
    `Selamat datang kembali, ${userLogin.nama} ðŸ‘‹`;
}

/* =======================
   LOGOUT
======================= */
function logout() {
  localStorage.removeItem("statusLogin");
  localStorage.removeItem("userLogin");

  document.getElementById("dashboard").style.display = "none";
  document.getElementById("loginPage").style.display = "block";
}

/* =======================
   AUTO LOGIN JIKA SUDAH LOGIN
======================= */
if (localStorage.getItem("statusLogin") === "true") {
  tampilDashboard();
}
</script>

</body>
</html>
